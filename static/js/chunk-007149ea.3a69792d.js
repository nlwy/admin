(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-007149ea"],{"040b":function(e,t,a){},"42a5":function(e,t,a){"use strict";var n=a("57b8"),r=a.n(n);r.a},"57b8":function(e,t,a){},7441:function(e,t,a){"use strict";var n=a("040b"),r=a.n(n);r.a},d930:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"overview"},[a("el-card",{staticClass:"card-table"},[a("div",{staticClass:"button-list"},[a("el-input",{attrs:{clearable:"",placeholder:"输入导出的文件名称",type:"text"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("div",{staticClass:"switch"},[a("el-switch",{attrs:{"active-color":"#13ce66","active-text":"自动宽度","inactive-color":"#ccc"},model:{value:e.autoWidth,callback:function(t){e.autoWidth=t},expression:"autoWidth"}})],1),a("upload-excel",{attrs:{"on-success":e.generateData}}),a("el-button",{attrs:{type:"primary"},on:{click:e.excelDow}},[e._v("导出筛选数据")]),a("el-button",{attrs:{type:"danger"}},[e._v("同步到明道云")])],1)]),a("el-card",{staticClass:"card-table",staticStyle:{"margin-top":"20px"}},[a("div",{staticClass:"content-table"},[a("div",{staticClass:"number"},[e._v("一共"+e._s(e.length)+"条数据")]),a("el-table",{attrs:{data:e.tabList,stripe:""}},e._l(e.tabHeader,(function(e){return a("el-table-column",{key:e,attrs:{label:e,prop:e}})})),1)],1)])],1)},r=[],c=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),s=a("2f62"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"excelIn"},[a("input",{ref:"fileExcel",staticClass:"upFile",attrs:{accept:".xlsx, .xls",type:"file"},on:{change:e.uploadFile}}),a("el-button",{attrs:{type:"success"},on:{click:e.handleClick}},[e._v("导入源数据")])],1)},i=[],o=a("1146"),u=a.n(o),d={props:{breforeUpload:Function,onSuccess:Function},data:function(){return{excelList:{header:null,results:null}}},methods:{handleClick:function(){this.$refs.fileExcel.click()},generateData:function(e){var t=e.header,a=e.results;this.excelList.header=t,this.excelList.results=a,this.onSuccess&&this.onSuccess(this.excelList)},uploadFile:function(e){var t=e.target.files[0];this.$refs.fileExcel.value=null,this.readData(t)},readData:function(e){var t=this;return new Promise((function(a){var n=new FileReader;n.onload=function(e){var n=e.target.result,r=u.a.read(n,{type:"array"}),c=r.SheetNames[0],s=r.Sheets[c],l=t.getHeaderRow(s),i=u.a.utils.sheet_to_json(s);t.generateData({header:l,results:i}),a()},n.readAsArrayBuffer(e)}))},getHeaderRow:function(e){var t,a=[],n=u.a.utils.decode_range(e["!ref"]),r=n.s.r;for(t=n.s.c;t<=n.e.c;++t){var c=e[u.a.utils.encode_cell({c:t,r:r})],s="UNKNOWN "+t;c&&c.t&&(s=u.a.utils.format_cell(c)),a.push(s)}return a}}},f=d,b=(a("7441"),a("2877")),p=Object(b["a"])(f,l,i,!1,null,"242c0d26",null),h=p.exports;function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){Object(c["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var x={computed:m({},Object(s["b"])(["roles"])),data:function(){return{autoWidth:!1,tabList:[],tabHeader:["商品名称","商品店铺名称","商品数量","预估金额","订单状态"],length:0,filename:""}},methods:{excelDow:function(){var e=this;a.e("chunk-350d80be").then(a.bind(null,"4bf8d")).then((function(t){var a=e.tabHeader,n=e.tabHeader,r=e.tabFullList,c=e.formatJson(n,r);t.export_json_to_excel({header:a,data:c,filename:""===e.filename?"京东数据":e.filename,autoWidth:e.autoWidth,bookType:e.bookType})}))},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},generateData:function(e){e.header;var t=e.results;this.length=t.length,this.tabList=t.slice(0,100),this.tabFullList=t}},components:{UploadExcel:h}},y=x,g=(a("42a5"),Object(b["a"])(y,n,r,!1,null,"68ee0b8c",null));t["default"]=g.exports}}]);